{
  "info": {
    "name": "Click-se Sistema - Planos e Funcionalidades",
    "description": "Collection com todas as APIs do sistema de planos e funcionalidades",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "name": "Webhook Hotmart - Sandbox",
      "item": [
        {
          "name": "Sandbox - Testar Webhook (GET - Mockado)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/webhooks/hotmart/sandbox?email=usuario@exemplo.com&plano=BASICO_MENSAL&evento=PURCHASE_APPROVED",
              "host": ["{{base_url}}"],
              "path": ["api", "webhooks", "hotmart", "sandbox"],
              "query": [
                { "key": "email", "value": "usuario@exemplo.com" },
                { "key": "plano", "value": "BASICO_MENSAL" },
                { "key": "evento", "value": "PURCHASE_APPROVED" }
              ]
            },
            "description": "Endpoint GET para testar o webhook mockado do Hotmart no sandbox"
          }
        },
        {
          "name": "Sandbox - PURCHASE_APPROVED",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"event\": \"PURCHASE_APPROVED\",\n  \"data\": {\n    \"subscription\": {\n      \"subscription_code\": \"SUB-SANDBOX-123456\",\n      \"plan\": { \"plan_code\": \"BASICO_MENSAL\" },\n      \"buyer\": { \"email\": \"cliente@exemplo.com\", \"name\": \"Nome do Cliente\" },\n      \"status\": \"TRIAL\",\n      \"trial_period_end\": \"2025-01-15T00:00:00Z\",\n      \"date_next_charge\": \"2025-01-22T00:00:00Z\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/webhooks/hotmart/sandbox",
              "host": ["{{base_url}}"],
              "path": ["api", "webhooks", "hotmart", "sandbox"]
            }
          }
        },
        {
          "name": "Sandbox - PURCHASE_COMPLETED",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"event\": \"PURCHASE_COMPLETED\",\n  \"data\": {\n    \"subscription\": {\n      \"subscription_code\": \"SUB-SANDBOX-123456\",\n      \"plan\": { \"plan_code\": \"BASICO_MENSAL\" },\n      \"buyer\": { \"email\": \"cliente@exemplo.com\", \"name\": \"Nome do Cliente\" },\n      \"status\": \"ACTIVE\",\n      \"date_next_charge\": \"2025-02-22T00:00:00Z\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/webhooks/hotmart/sandbox",
              "host": ["{{base_url}}"],
              "path": ["api", "webhooks", "hotmart", "sandbox"]
            }
          }
        },
        {
          "name": "Sandbox - PURCHASE_RENEWED (CHARGED/UPDATED)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"event\": \"PURCHASE_CHARGED\",\n  \"data\": {\n    \"subscription\": {\n      \"subscription_code\": \"SUB-SANDBOX-123456\",\n      \"plan\": { \"plan_code\": \"BASICO_MENSAL\" },\n      \"buyer\": { \"email\": \"cliente@exemplo.com\" },\n      \"status\": \"ACTIVE\",\n      \"date_next_charge\": \"2025-03-22T00:00:00Z\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/webhooks/hotmart/sandbox",
              "host": ["{{base_url}}"],
              "path": ["api", "webhooks", "hotmart", "sandbox"]
            }
          }
        },
        {
          "name": "Sandbox - PURCHASE_CANCELLED",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"event\": \"PURCHASE_CANCELLED\",\n  \"data\": {\n    \"subscription\": {\n      \"subscription_code\": \"SUB-SANDBOX-123456\",\n      \"plan\": { \"plan_code\": \"BASICO_MENSAL\" },\n      \"buyer\": { \"email\": \"cliente@exemplo.com\" },\n      \"status\": \"CANCELLED\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/webhooks/hotmart/sandbox",
              "host": ["{{base_url}}"],
              "path": ["api", "webhooks", "hotmart", "sandbox"]
            }
          }
        },
        {
          "name": "Sandbox - PURCHASE_EXPIRED",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"event\": \"PURCHASE_EXPIRED\",\n  \"data\": {\n    \"subscription\": {\n      \"subscription_code\": \"SUB-SANDBOX-123456\",\n      \"plan\": { \"plan_code\": \"BASICO_MENSAL\" },\n      \"buyer\": { \"email\": \"cliente@exemplo.com\" },\n      \"status\": \"EXPIRED\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/webhooks/hotmart/sandbox",
              "host": ["{{base_url}}"],
              "path": ["api", "webhooks", "hotmart", "sandbox"]
            }
          }
        },
        {
          "name": "Sandbox - SUBSCRIPTION_SUSPENDED (Compatível)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"event\": \"SUBSCRIPTION_SUSPENDED\",\n  \"data\": {\n    \"subscription\": {\n      \"code\": \"SUB-SANDBOX-123456\",\n      \"plan\": { \"code\": \"BASICO_MENSAL\" },\n      \"buyer\": { \"email\": \"cliente@exemplo.com\" },\n      \"status\": \"SUSPENDED\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/webhooks/hotmart/sandbox",
              "host": ["{{base_url}}"],
              "path": ["api", "webhooks", "hotmart", "sandbox"]
            }
          }
        }
      ]
    },
    {
      "key": "auth_token",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Funcionalidades",
      "item": [
        {
          "name": "Listar Funcionalidades",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/funcionalidades",
              "host": ["{{base_url}}"],
              "path": ["api", "funcionalidades"]
            }
          }
        },
        {
          "name": "Criar Funcionalidade",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"codigo\": \"EVENTOS_ILIMITADOS\",\n  \"nome\": \"Eventos Ilimitados\",\n  \"descricao\": \"Criar eventos sem limite\",\n  \"categoria\": \"EVENTOS\",\n  \"ativo\": true,\n  \"ordem\": 1\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/funcionalidades",
              "host": ["{{base_url}}"],
              "path": ["api", "funcionalidades"]
            }
          }
        },
        {
          "name": "Buscar Funcionalidade por ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/funcionalidades/:id",
              "host": ["{{base_url}}"],
              "path": ["api", "funcionalidades", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "name": "Atualizar Funcionalidade",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nome\": \"Eventos Ilimitados (Atualizado)\",\n  \"ativo\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/funcionalidades/:id",
              "host": ["{{base_url}}"],
              "path": ["api", "funcionalidades", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "name": "Deletar Funcionalidade",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/funcionalidades/:id",
              "host": ["{{base_url}}"],
              "path": ["api", "funcionalidades", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": ""
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Planos",
      "item": [
        {
          "name": "Listar Planos",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/planos?ativos=true",
              "host": ["{{base_url}}"],
              "path": ["api", "planos"],
              "query": [
                {
                  "key": "ativos",
                  "value": "true"
                }
              ]
            }
          }
        },
        {
          "name": "Criar Plano",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nome\": \"Basico\",\n  \"descricao\": \"Plano ideal para comecar a usar o sistema\",\n  \"codigoHotmart\": \"BASICO_MENSAL\",\n  \"funcionalidades\": [\"func_id_1\", \"func_id_2\"],\n  \"preco\": 49.90,\n  \"intervalo\": \"mensal\",\n  \"ativo\": true,\n  \"destaque\": true,\n  \"limiteEventos\": 10,\n  \"limiteClientes\": 50,\n  \"limiteUsuarios\": 1\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/planos",
              "host": ["{{base_url}}"],
              "path": ["api", "planos"]
            }
          }
        },
        {
          "name": "Buscar Plano por ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/planos/:id",
              "host": ["{{base_url}}"],
              "path": ["api", "planos", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "name": "Atualizar Plano",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nome\": \"Básico (Atualizado)\",\n  \"preco\": 59.90,\n  \"ativo\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/planos/:id",
              "host": ["{{base_url}}"],
              "path": ["api", "planos", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "name": "Deletar Plano",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/planos/:id",
              "host": ["{{base_url}}"],
              "path": ["api", "planos", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": ""
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Assinaturas",
      "item": [
        {
          "name": "Buscar Minha Assinatura",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/assinaturas",
              "host": ["{{base_url}}"],
              "path": ["api", "assinaturas"]
            }
          }
        },
        {
          "name": "Buscar Assinatura por User ID (Admin)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/assinaturas?userId=user_id_aqui",
              "host": ["{{base_url}}"],
              "path": ["api", "assinaturas"],
              "query": [
                {
                  "key": "userId",
                  "value": "user_id_aqui"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Usuários e Assinaturas",
      "item": [
        {
          "name": "Obter Status do Plano",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/users/:id/assinatura",
              "host": ["{{base_url}}"],
              "path": ["api", "users", ":id", "assinatura"],
              "variable": [
                {
                  "key": "id",
                  "value": "",
                  "description": "ID do usuário"
                }
              ]
            },
            "description": "Obtém status completo do plano do usuário (próprio usuário ou admin)"
          }
        },
        {
          "name": "Atualizar Assinatura do Usuário (Admin)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"assinaturaId\": \"assinatura_id_aqui\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/users/:id/assinatura",
              "host": ["{{base_url}}"],
              "path": ["api", "users", ":id", "assinatura"],
              "variable": [
                {
                  "key": "id",
                  "value": "",
                  "description": "ID do usuário"
                }
              ]
            },
            "description": "Atualiza assinatura do usuário (apenas admin)"
          }
        },
        {
          "name": "Sincronizar Plano do Usuário (Admin)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"sincronizar\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/users/:id/assinatura",
              "host": ["{{base_url}}"],
              "path": ["api", "users", ":id", "assinatura"],
              "variable": [
                {
                  "key": "id",
                  "value": "",
                  "description": "ID do usuário"
                }
              ]
            },
            "description": "Força sincronização dos dados do plano no usuário (apenas admin)"
          }
        }
      ]
    },
    {
      "name": "Webhook Hotmart",
      "item": [
        {
          "name": "Testar Webhook (GET - Mockado)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/webhooks/hotmart?email=usuario@exemplo.com&plano=PROFISSIONAL_MENSAL&evento=SUBSCRIPTION_PURCHASE",
              "host": ["{{base_url}}"],
              "path": ["api", "webhooks", "hotmart"],
              "query": [
                {
                  "key": "email",
                  "value": "usuario@exemplo.com"
                },
                {
                  "key": "plano",
                  "value": "PROFISSIONAL_MENSAL"
                },
                {
                  "key": "evento",
                  "value": "SUBSCRIPTION_PURCHASE"
                }
              ]
            },
            "description": "Endpoint GET para testar o webhook mockado da Hotmart"
          }
        },
        {
          "name": "Webhook Hotmart (POST - Produção)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"event\": \"SUBSCRIPTION_PURCHASE\",\n  \"data\": {\n    \"subscription\": {\n      \"code\": \"SUB-123456\",\n      \"plan\": {\n        \"code\": \"PROFISSIONAL_MENSAL\"\n      },\n      \"buyer\": {\n        \"email\": \"cliente@exemplo.com\",\n        \"name\": \"Nome do Cliente\"\n      },\n      \"status\": \"TRIAL\",\n      \"trial_period_end\": \"2025-01-15T00:00:00Z\",\n      \"date_next_charge\": \"2025-01-22T00:00:00Z\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/webhooks/hotmart",
              "host": ["{{base_url}}"],
              "path": ["api", "webhooks", "hotmart"]
            },
            "description": "Endpoint POST para receber webhooks da Hotmart (quando integração real for feita)"
          }
        },
        {
          "name": "Webhook - Assinatura Ativada",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"event\": \"SUBSCRIPTION_ACTIVATED\",\n  \"data\": {\n    \"subscription\": {\n      \"code\": \"SUB-123456\",\n      \"plan\": {\n        \"code\": \"PROFISSIONAL_MENSAL\"\n      },\n      \"buyer\": {\n        \"email\": \"cliente@exemplo.com\",\n        \"name\": \"Nome do Cliente\"\n      },\n      \"status\": \"ACTIVE\",\n      \"date_next_charge\": \"2025-02-22T00:00:00Z\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/webhooks/hotmart",
              "host": ["{{base_url}}"],
              "path": ["api", "webhooks", "hotmart"]
            }
          }
        },
        {
          "name": "Webhook - Assinatura Cancelada",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"event\": \"SUBSCRIPTION_CANCELLED\",\n  \"data\": {\n    \"subscription\": {\n      \"code\": \"SUB-123456\",\n      \"plan\": {\n        \"code\": \"PROFISSIONAL_MENSAL\"\n      },\n      \"buyer\": {\n        \"email\": \"cliente@exemplo.com\",\n        \"name\": \"Nome do Cliente\"\n      },\n      \"status\": \"CANCELLED\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/webhooks/hotmart",
              "host": ["{{base_url}}"],
              "path": ["api", "webhooks", "hotmart"]
            }
          }
        },
        {
          "name": "Webhook - Assinatura Expirada",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"event\": \"SUBSCRIPTION_EXPIRED\",\n  \"data\": {\n    \"subscription\": {\n      \"code\": \"SUB-123456\",\n      \"plan\": {\n        \"code\": \"PROFISSIONAL_MENSAL\"\n      },\n      \"buyer\": {\n        \"email\": \"cliente@exemplo.com\",\n        \"name\": \"Nome do Cliente\"\n      },\n      \"status\": \"EXPIRED\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/webhooks/hotmart",
              "host": ["{{base_url}}"],
              "path": ["api", "webhooks", "hotmart"]
            }
          }
        },
        {
          "name": "Webhook - Assinatura Renovada",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"event\": \"SUBSCRIPTION_RENEWED\",\n  \"data\": {\n    \"subscription\": {\n      \"code\": \"SUB-123456\",\n      \"plan\": {\n        \"code\": \"PROFISSIONAL_MENSAL\"\n      },\n      \"buyer\": {\n        \"email\": \"cliente@exemplo.com\",\n        \"name\": \"Nome do Cliente\"\n      },\n      \"status\": \"ACTIVE\",\n      \"date_next_charge\": \"2025-03-22T00:00:00Z\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/webhooks/hotmart",
              "host": ["{{base_url}}"],
              "path": ["api", "webhooks", "hotmart"]
            }
          }
        },
        {
          "name": "Webhook - Assinatura Suspensa",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"event\": \"SUBSCRIPTION_SUSPENDED\",\n  \"data\": {\n    \"subscription\": {\n      \"code\": \"SUB-123456\",\n      \"plan\": {\n        \"code\": \"PROFISSIONAL_MENSAL\"\n      },\n      \"buyer\": {\n        \"email\": \"cliente@exemplo.com\",\n        \"name\": \"Nome do Cliente\"\n      },\n      \"status\": \"SUSPENDED\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/webhooks/hotmart",
              "host": ["{{base_url}}"],
              "path": ["api", "webhooks", "hotmart"]
            }
          }
        }
      ]
    },
    {
      "name": "Pagamentos",
      "item": [
        {
          "name": "Atualizar Pagamentos (Normalização)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "x-api-key",
                "value": "dev-seed-key-2024",
                "description": "API key para bypass de autenticação em dev (ou usar SEED_API_KEY no .env)"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": \"seu_user_id_aqui\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/pagamentos/atualiza-pagamento",
              "host": ["{{base_url}}"],
              "path": ["api", "pagamentos", "atualiza-pagamento"]
            },
            "description": "Normaliza pagamentos existentes da collection de eventos para a collection global. Busca todos os pagamentos em users/{userId}/eventos/{eventoId}/pagamentos e os cria em users/{userId}/pagamentos. Pode ser executado múltiplas vezes (idempotente).\n\nOpções de autenticação:\n1. Via sessão (se estiver logado no navegador)\n2. Via API key (x-api-key header) + userId no body\n3. Em modo dev, apenas userId no body"
          }
        }
      ]
    },
    {
      "name": "Custos",
      "item": [
        {
          "name": "Atualizar Custos (Normalização)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "x-api-key",
                "value": "dev-seed-key-2024",
                "description": "API key para bypass de autenticação em dev (ou usar SEED_API_KEY no .env)"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": \"seu_user_id_aqui\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/custos/atualiza-custo",
              "host": ["{{base_url}}"],
              "path": ["api", "custos", "atualiza-custo"]
            },
            "description": "Normaliza custos existentes da collection de eventos para a collection global. Busca todos os custos em users/{userId}/eventos/{eventoId}/custos e os cria em users/{userId}/custos. Pode ser executado múltiplas vezes (idempotente).\n\nOpções de autenticação:\n1. Via sessão (se estiver logado no navegador)\n2. Via API key (x-api-key header) + userId no body\n3. Em modo dev, apenas userId no body"
          }
        },
        {
          "name": "Atualizar Serviços (Normalização)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "x-api-key",
                "value": "dev-seed-key-2024",
                "description": "API key para bypass de autenticação em dev (ou usar SEED_API_KEY no .env)"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": \"seu_user_id_aqui\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/servicos/atualiza-servico",
              "host": ["{{base_url}}"],
              "path": ["api", "servicos", "atualiza-servico"]
            },
            "description": "Normaliza serviços existentes da collection de eventos para a collection global. Busca todos os serviços em users/{userId}/eventos/{eventoId}/servicos e os cria em users/{userId}/servicos. Pode ser executado múltiplas vezes (idempotente).\n\nOpções de autenticação:\n1. Via sessão (se estiver logado no navegador)\n2. Via API key (x-api-key header) + userId no body\n3. Em modo dev, apenas userId no body"
          }
        }
      ]
    },
    {
      "name": "Planos",
      "item": [
        {
          "name": "Alterar Plano",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "x-api-key",
                "value": "dev-seed-key-2024",
                "description": "API key para bypass de autenticação em dev (ou usar SEED_API_KEY no .env)"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"usuario@exemplo.com\",\n  \"codigoHotmart\": \"PROFISSIONAL_MENSAL\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/alterar-plano",
              "host": ["{{base_url}}"],
              "path": ["api", "alterar-plano"]
            },
            "description": "Altera o plano de um usuário pelo email e codigoHotmart. Se o usuário não tiver plano, cria uma nova assinatura. Se já tiver, atualiza para o novo plano.\n\nParâmetros:\n- email (string): Email do usuário\n- codigoHotmart (string): Código do plano na Hotmart (ex: PROFISSIONAL_MENSAL, BASICO_MENSAL, ENTERPRISE_MENSAL)\n\nOpções de autenticação:\n1. Via sessão admin\n2. Via API key (x-api-key header)\n3. Em modo dev, sem autenticação"
          }
        }
      ]
    },
    {
      "name": "Seed e Setup",
      "item": [
        {
          "name": "Seed Funcionalidades e Planos",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "x-api-key",
                "value": "dev-seed-key-2024",
                "description": "API key para bypass de autenticação em dev (ou usar SEED_API_KEY no .env)"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": {
              "raw": "{{base_url}}/api/seed/funcionalidades-planos",
              "host": ["{{base_url}}"],
              "path": ["api", "seed", "funcionalidades-planos"]
            },
            "description": "Cria 24 funcionalidades e 3 planos iniciais (Básico, Profissional, Enterprise). Funciona em modo dev sem autenticação, ou com x-api-key header."
          }
        },
        {
          "name": "Criar Usuário Admin",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": {
              "raw": "{{base_url}}/api/admin/create-default-admin",
              "host": ["{{base_url}}"],
              "path": ["api", "admin", "create-default-admin"]
            },
            "description": "Cria usuário admin@clickse.com com senha 123456"
          }
        },
        {
          "name": "Seed com Reset",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "x-api-key",
                "value": "dev-seed-key-2024",
                "description": "API key para bypass de autenticação em dev"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": {
              "raw": "{{base_url}}/api/seed/funcionalidades-planos?reset=true",
              "host": ["{{base_url}}"],
              "path": ["api", "seed", "funcionalidades-planos"],
              "query": [
                {
                  "key": "reset",
                  "value": "true",
                  "description": "Limpa tudo e recria do zero"
                }
              ]
            },
            "description": "Executa seed com reset completo (remove todas funcionalidades e planos antes de recriar)"
          }
        },
        {
          "name": "Migrar Usuários para Planos",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "x-api-key",
                "value": "dev-seed-key-2024",
                "description": "API key para bypass de autenticação em dev (ou usar SEED_API_KEY no .env)"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"planoPadrao\": \"BASICO_MENSAL\",\n  \"statusPadrao\": \"active\",\n  \"dataExpiracao\": null,\n  \"dryRun\": false\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/admin/migrate-users-to-plans",
              "host": ["{{base_url}}"],
              "path": ["api", "admin", "migrate-users-to-plans"]
            },
            "description": "Migra usuários existentes para planos. dryRun=true apenas simula sem aplicar mudanças. Requer autenticação admin."
          }
        },
        {
          "name": "Migrar Usuários - Dry Run",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "x-api-key",
                "value": "dev-seed-key-2024",
                "description": "API key para bypass de autenticação em dev (ou usar SEED_API_KEY no .env)"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"planoPadrao\": \"BASICO_MENSAL\",\n  \"statusPadrao\": \"active\",\n  \"dryRun\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/admin/migrate-users-to-plans",
              "host": ["{{base_url}}"],
              "path": ["api", "admin", "migrate-users-to-plans"]
            },
            "description": "Simula migração sem aplicar mudanças (dryRun=true)"
          }
        },
        {
          "name": "Migrar Campos de Integridade de Dados",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "x-api-key",
                "value": "dev-seed-key-2024",
                "description": "API key para bypass de autenticação em dev (ou usar SEED_API_KEY no .env)"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dryRun\": false\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/admin/migrate-data-integrity-fields",
              "host": ["{{base_url}}"],
              "path": ["api", "admin", "migrate-data-integrity-fields"]
            },
            "description": "Adiciona campos de integridade (ativo, arquivado) em dados existentes. dryRun=true apenas simula sem aplicar mudanças. Requer autenticação admin."
          }
        },
        {
          "name": "Migrar Campos de Integridade - Dry Run",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "x-api-key",
                "value": "dev-seed-key-2024",
                "description": "API key para bypass de autenticação em dev (ou usar SEED_API_KEY no .env)"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dryRun\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/admin/migrate-data-integrity-fields",
              "host": ["{{base_url}}"],
              "path": ["api", "admin", "migrate-data-integrity-fields"]
            },
            "description": "Simula migração de campos de integridade sem aplicar mudanças (dryRun=true)"
          }
        },
        {
          "name": "Gerar Eventos Aleatórios (Teste de Estresse)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "x-api-key",
                "value": "dev-seed-key-2024",
                "description": "API key para bypass de autenticação em dev (opcional)"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"usuario@exemplo.com\",\n  \"quantidadeEventos\": 100,\n  \"custos\": true,\n  \"pagamento\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/test/generate-events",
              "host": ["{{base_url}}"],
              "path": ["api", "test", "generate-events"]
            },
            "description": "Gera eventos aleatórios para testes de estresse. Parâmetros: email (string) - email da conta, quantidadeEventos (number) - número de eventos (1-1000), custos (boolean) - adiciona 3 custos por evento, pagamento (boolean) - adiciona pagamento por evento. Cada evento inclui: cliente aleatório, tipo de evento aleatório, status aleatório, 2 serviços aleatórios. Ignora validações de plano."
          }
        }
      ]
    },
    {
      "name": "Google Calendar",
      "item": [
        {
          "name": "Status da Conexão",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/google-calendar/status",
              "host": ["{{base_url}}"],
              "path": ["api", "google-calendar", "status"]
            },
            "description": "Obtém o status da conexão com Google Calendar. Retorna se está conectado, se sincronização está ativa, email da conta, etc. Requer autenticação."
          }
        },
        {
          "name": "Iniciar Conexão OAuth",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/google-calendar/auth?force=false",
              "host": ["{{base_url}}"],
              "path": ["api", "google-calendar", "auth"],
              "query": [
                {
                  "key": "force",
                  "value": "false",
                  "description": "Se true, força nova autorização mesmo se já autorizou antes"
                }
              ]
            },
            "description": "Inicia o fluxo OAuth do Google Calendar. Redireciona para página de autorização do Google. Requer autenticação e plano permitido (Profissional ou Enterprise)."
          }
        },
        {
          "name": "Desconectar Google Calendar",
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/google-calendar/disconnect",
              "host": ["{{base_url}}"],
              "path": ["api", "google-calendar", "disconnect"]
            },
            "description": "Desconecta a conta do Google Calendar. Remove tokens armazenados. Requer autenticação."
          }
        },
        {
          "name": "Ativar/Desativar Sincronização",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"syncEnabled\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/google-calendar/toggle-sync",
              "host": ["{{base_url}}"],
              "path": ["api", "google-calendar", "toggle-sync"]
            },
            "description": "Ativa ou desativa a sincronização automática com Google Calendar. Requer autenticação e conexão ativa."
          }
        },
        {
          "name": "Informações de Debug",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/google-calendar/debug",
              "host": ["{{base_url}}"],
              "path": ["api", "google-calendar", "debug"]
            },
            "description": "Retorna informações detalhadas de debug sobre tokens, conexão e validação. Inclui access token, refresh token, status de expiração, validação do token, etc. Útil para desenvolvimento. Requer autenticação."
          }
        },
        {
          "name": "Criar Evento no Google Calendar",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"summary\": \"Reunião com cliente\",\n  \"description\": \"Discussão sobre novo projeto\",\n  \"startDateTime\": \"2025-01-20T14:00:00\",\n  \"endDateTime\": \"2025-01-20T15:30:00\",\n  \"location\": \"Rua das Flores, 123 - São Paulo, SP\",\n  \"timeZone\": \"America/Sao_Paulo\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/google-calendar/events",
              "host": ["{{base_url}}"],
              "path": ["api", "google-calendar", "events"]
            },
            "description": "Cria um evento diretamente no Google Calendar. Campos obrigatórios: summary, startDateTime. Campos opcionais: description, endDateTime, location, timeZone (padrão: America/Sao_Paulo). Requer autenticação, plano permitido e sincronização ativa."
          }
        },
        {
          "name": "Forçar Renovação do Token",
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/google-calendar/refresh-token",
              "host": ["{{base_url}}"],
              "path": ["api", "google-calendar", "refresh-token"]
            },
            "description": "Força a renovação do access token usando o refresh token. Útil quando o token está expirado ou inválido. Requer autenticação e conexão ativa."
          }
        }
      ]
    }
  ]
}

